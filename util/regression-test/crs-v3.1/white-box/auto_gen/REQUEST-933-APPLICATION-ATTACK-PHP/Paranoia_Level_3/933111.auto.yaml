meta:
  author: msra
  description: None
  enabled: true
  name: 933111.yaml
tests:
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - "Content-Disposition: form-data; name=\"files[]\"; filename=\"\tk.PHtml.o\""
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-1-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="''/.PHp3.F_"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-2-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - "Content-Disposition: form-data; name=\"files[]\"; filename=\">.phTml.'\r\
          \""
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-3-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - "Content-Disposition: form-data; name=\"files[]\"; filename=\"\f.PHtmL.B\""
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-4-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="6.PhP.I"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-5-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="^W.PhtMl.iQ"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-6-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename=")/.phP3.R"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-7-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="s@.pHTml.<"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-8-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="8.phP.! "'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-9-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="A.pHtmL.@"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-10-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: "$_.php6.[\v"
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-11-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: A.pHp.PI
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-12-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: 4S.PhtML.#l
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-13-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: D.Php.A
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-14-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: ZR.pHp.ZM
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-15-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: R.pHtMl.yB
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-16-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: R.PhtMl.^
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-17-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: X.PHtml.L^
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-18-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: J.phP.[
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-19-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: Y.Php.pK
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-20-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: UK.PHP.O
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-21-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: R}.pHTMl.C|
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-22-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: 7i.phP.+
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-23-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: s .php3.Z%
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-24-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: "\f.phTmL.p$"
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-25-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: 3.PhP.B@
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-26-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: P9.PHTMl.I
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-27-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: K?.PhtMl.L
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        log_contains: id "933111"
  test_title: 933111-28-auto
