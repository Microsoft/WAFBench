meta:
  author: msra
  description: None
  enabled: true
  name: 933110.yaml
tests:
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename=" D.Phtml"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-1-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="G.pHTMl."'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-2-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="Z`.phtml."'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-3-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="&.php3"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-4-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="eF.PHp2."'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-5-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="HD.PHP9"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-6-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="2A.pHp4"'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-7-auto
- stages:
  - stage:
      input:
        data:
        - '------abc'
        - 'Content-Disposition: form-data; name="files[]"; filename="=.pHP1."'
        - 'Content-Type: text/plain'
        - ''
        - 'Content '
        - ''
        - '------abc--'
        dest_addr: 127.0.0.1
        headers:
          Cache-Control: no-cache
          Content-Type: multipart/form-data; boundary=----abc
          Host: localhost
        method: POST
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-8-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: '`K.phTml'
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-9-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: "\f.php."
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-10-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: '!J.phP1'
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-11-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: VD.PHTmL
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-12-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: e.Php1
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-13-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: =I.PhtmL
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-14-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: C.pHP.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-15-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: :G.phP.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-16-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: '@T.phtML'
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-17-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-Filename: SU.PHP.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-18-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: "\t\".PHP4"
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-19-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: p.pHTMl.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-20-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: '>.PHtML.'
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-21-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: 4.pHTMl
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-22-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: 1.pHTml.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-23-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: \P.PHp0.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-24-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: 2%.PHtml.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-25-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: -%.phTmL
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-26-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: ~.PhP0.
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-27-auto
- stages:
  - stage:
      input:
        dest_addr: 127.0.0.1
        headers:
          Host: localhost
          X-File-Name: L.pHP..
        method: GET
        port: 80
        protocol: http
        version: HTTP/1.1
      output:
        status:
        - 403
  test_title: 933110-28-auto
